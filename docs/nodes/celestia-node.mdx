---
sidebar_label: Installing Celestia Node
---

import constants from "../../versions/constants.js";
import mochaVersions from "../../versions/mocha_versions.js";
import arabicaVersions from "../../versions/arabica_versions.js";
import blockspaceraceVersions from "../../versions/blockspacerace_versions.js"

# Celestia Node

````mdx-code-block
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
````

This tutorial goes over building and installing `celestia-node`. This
tutorial assumes you completed the steps in setting up your development
environment [here](./environment.mdx).

## Install celestia-node

````mdx-code-block
<Tabs groupId="network">
<TabItem value="blockspacerace" label="Blockspace Race">

<Tabs groupId="operating-systems">
<TabItem value="amd" label="Ubuntu (AMD)">

Installing `celestia-node` for the Blockspace Race testnet means installing a specific version
to be compatible with the network.

Install the `celestia-node` binary by running the following commands:

<pre><code>
cd $HOME <br/>
rm -rf celestia-node <br/>
git clone https://github.com/celestiaorg/celestia-node.git <br/>
cd celestia-node/ <br/>
git checkout tags/{blockspaceraceVersions['node-latest-tag']} <br/>
make build <br/>
make install <br/>
make cel-key <br/>
</code></pre>

Verify that the binary is working and check the version with the `celestia
version` command:

<pre><code>
$ celestia version <br/>
Semantic version: {blockspaceraceVersions['node-latest-tag']} <br/>
Commit: {blockspaceraceVersions['node-latest-sha']} <br/>
Build Date: Thu Dec 15 10:19:22 PM UTC 2022 <br/>
System version: amd64/linux <br/>
Golang version: go{constants.golangNode} <br/>
</code></pre>

</TabItem>
<TabItem value="arm" label="Ubuntu (ARM)">

Installing `celestia-node` for the Blockspace Race testnet means installing a specific version
to be compatible with the network.

Install the `celestia-node` binary by running the following commands:

<pre><code>
cd $HOME <br/>
rm -rf celestia-node <br/>
git clone https://github.com/celestiaorg/celestia-node.git <br/>
cd celestia-node/ <br/>
git checkout tags/{blockspaceraceVersions['node-latest-tag']} <br/>
make build <br/>
make install <br/>
make cel-key <br/>
</code></pre>

Verify that the binary is working and check the version with the `celestia
version` command:

<pre><code>
$ celestia version <br/>
Semantic version: {blockspaceraceVersions['node-latest-tag']} <br/>
Commit: {blockspaceraceVersions['node-latest-sha']} <br/>
Build Date: Thu Dec 15 10:19:22 PM UTC 2022 <br/>
System version: arm64/linux <br/>
Golang version: go{constants.golangNode} <br/>
</code></pre>

</TabItem>
<TabItem value="apple" label="Mac (Apple)">

Installing `celestia-node` for the Blockspace Race testnet means installing a specific version
to be compatible with the network.

Install the `celestia-node` binary by running the following commands:

<pre><code>
cd $HOME <br/>
rm -rf celestia-node <br/>
git clone https://github.com/celestiaorg/celestia-node.git <br/>
cd celestia-node/ <br/>
git checkout tags/{blockspaceraceVersions['node-latest-tag']} <br/>
make build <br/>
make go-install <br/>
make cel-key <br/>
</code></pre>

Verify that the binary is working and check the version with the `celestia
version` command:

<pre><code>
$ celestia version <br/>
Semantic version: {blockspaceraceVersions['node-latest-tag']} <br/>
Commit: {blockspaceraceVersions['node-latest-sha']} <br/>
Build Date: Thu Dec 15 10:19:22 PM UTC 2022 <br/>
System version: arm64/darwin <br/>
Golang version: go{constants.golangNode} <br/>
</code></pre>

</TabItem>
<TabItem value="mac" label="Mac (Intel)">

Installing `celestia-node` for the Blockspace Race testnet means installing a specific version
to be compatible with the network.

Install the `celestia-node` binary by running the following commands:

<pre><code>
cd $HOME <br/>
rm -rf celestia-node <br/>
git clone https://github.com/celestiaorg/celestia-node.git <br/>
cd celestia-node/ <br/>
git checkout tags/{blockspaceraceVersions['node-latest-tag']} <br/>
make build <br/>
make go-install <br/>
make cel-key <br/>
</code></pre>

Verify that the binary is working and check the version with the `celestia
version` command:

<pre><code>
$ celestia version <br/>
Semantic version: {blockspaceraceVersions['node-latest-tag']} <br/>
Commit: {blockspaceraceVersions['node-latest-sha']} <br/>
Build Date: Thu Dec 15 10:19:22 PM UTC 2022 <br/>
System version: amd64/darwin <br/>
Golang version: go{constants.golangNode} <br/>
</code></pre>

</TabItem>
</Tabs>

</TabItem>
<TabItem value="mocha" label="Mocha">

<Tabs groupId="operating-systems">
<TabItem value="amd" label="Ubuntu (AMD)">

Installing `celestia-node` for Mocha Testnet means installing a specific version
to be compatible with the network.

Install the `celestia-node` binary by running the following commands:

<pre><code>
cd $HOME <br/>
rm -rf celestia-node <br/>
git clone https://github.com/celestiaorg/celestia-node.git <br/>
cd celestia-node/ <br/>
git checkout tags/{mochaVersions['node-latest-tag']} <br/>
make build <br/>
make install <br/>
make cel-key <br/>
</code></pre>

Verify that the binary is working and check the version with the `celestia
version` command:

<pre><code>
$ celestia version <br/>
Semantic version: {mochaVersions['node-latest-tag']} <br/>
Commit: {mochaVersions['node-latest-sha']} <br/>
Build Date: Thu Dec 15 10:19:22 PM UTC 2022 <br/>
System version: amd64/linux <br/>
Golang version: go{constants.golangNode} <br/>
</code></pre>

</TabItem>
<TabItem value="arm" label="Ubuntu (ARM)">

Installing `celestia-node` for Mocha Testnet means installing a specific version
to be compatible with the network.

Install the `celestia-node` binary by running the following commands:

<pre><code>
cd $HOME <br/>
rm -rf celestia-node <br/>
git clone https://github.com/celestiaorg/celestia-node.git <br/>
cd celestia-node/ <br/>
git checkout tags/{mochaVersions['node-latest-tag']} <br/>
make build <br/>
make install <br/>
make cel-key <br/>
</code></pre>

Verify that the binary is working and check the version with the `celestia
version` command:

<pre><code>
$ celestia version <br/>
Semantic version: {mochaVersions['node-latest-tag']} <br/>
Commit: {mochaVersions['node-latest-sha']} <br/>
Build Date: Thu Dec 15 10:19:22 PM UTC 2022 <br/>
System version: arm64/linux <br/>
Golang version: go{constants.golangNode} <br/>
</code></pre>

</TabItem>
<TabItem value="apple" label="Mac (Apple)">

Installing `celestia-node` for Mocha Testnet means installing a specific version
to be compatible with the network.

Install the `celestia-node` binary by running the following commands:

<pre><code>
cd $HOME <br/>
rm -rf celestia-node <br/>
git clone https://github.com/celestiaorg/celestia-node.git <br/>
cd celestia-node/ <br/>
git checkout tags/{mochaVersions['node-latest-tag']} <br/>
make build <br/>
make go-install <br/>
make cel-key <br/>
</code></pre>

Verify that the binary is working and check the version with the `celestia
version` command:

<pre><code>
$ celestia version <br/>
Semantic version: {mochaVersions['node-latest-tag']} <br/>
Commit: {mochaVersions['node-latest-sha']} <br/>
Build Date: Thu Dec 15 10:19:22 PM UTC 2022 <br/>
System version: arm64/darwin <br/>
Golang version: go{constants.golangNode} <br/>
</code></pre>

</TabItem>
<TabItem value="mac" label="Mac (Intel)">

Installing `celestia-node` for Mocha Testnet means installing a specific version
to be compatible with the network.

Install the `celestia-node` binary by running the following commands:

<pre><code>
cd $HOME <br/>
rm -rf celestia-node <br/>
git clone https://github.com/celestiaorg/celestia-node.git <br/>
cd celestia-node/ <br/>
git checkout tags/{mochaVersions['node-latest-tag']} <br/>
make build <br/>
make go-install <br/>
make cel-key <br/>
</code></pre>

Verify that the binary is working and check the version with the `celestia
version` command:

<pre><code>
$ celestia version <br/>
Semantic version: {mochaVersions['node-latest-tag']} <br/>
Commit: {mochaVersions['node-latest-sha']} <br/>
Build Date: Thu Dec 15 10:19:22 PM UTC 2022 <br/>
System version: amd64/darwin <br/>
Golang version: go{constants.golangNode} <br/>
</code></pre>

</TabItem>
</Tabs>

</TabItem>
<TabItem value="arabica" label="Arabica 🏗️">

<Tabs groupId="operating-systems">
<TabItem value="amd" label="Ubuntu (AMD)">

Installing `celestia-node` for Arabica Devnet means installing a specific version
to be compatible with the network.

Install the `celestia-node` binary by running the following commands:

<pre><code>
cd $HOME <br/>
rm -rf celestia-node <br/>
git clone https://github.com/celestiaorg/celestia-node.git <br/>
cd celestia-node/ <br/>
git checkout tags/{arabicaVersions['node-latest-tag']} <br/>
make build <br/>
make install <br/>
make cel-key <br/>
</code></pre>

Verify that the binary is working and check the version with the `celestia
version` command:

<pre><code>
$ celestia version <br/>
Semantic version: {arabicaVersions['node-latest-tag']} <br/>
Commit: {arabicaVersions['node-latest-sha']} <br/>
Build Date: Thu Dec 15 10:19:22 PM UTC 2022 <br/>
System version: amd64/linux <br/>
Golang version: go{constants.golangNode} <br/>
</code></pre>

</TabItem>
<TabItem value="arm" label="Ubuntu (ARM)">

Installing `celestia-node` for Arabica Devnet means installing a specific version
to be compatible with the network.

Install the `celestia-node` binary by running the following commands:

<pre><code>
cd $HOME <br/>
rm -rf celestia-node <br/>
git clone https://github.com/celestiaorg/celestia-node.git <br/>
cd celestia-node/ <br/>
git checkout tags/{arabicaVersions['node-latest-tag']} <br/>
make build <br/>
make install <br/>
make cel-key <br/>
</code></pre>

Verify that the binary is working and check the version with the `celestia
version` command:

<pre><code>
$ celestia version <br/>
Semantic version: {arabicaVersions['node-latest-tag']} <br/>
Commit: {arabicaVersions['node-latest-sha']} <br/>
Build Date: Thu Dec 15 10:19:22 PM UTC 2022 <br/>
System version: arm64/linux <br/>
Golang version: go{constants.golangNode} <br/>
</code></pre>

</TabItem>
<TabItem value="apple" label="Mac (Apple)">

Installing `celestia-node` for Arabica Devnet means installing a specific version
to be compatible with the network.

Install the `celestia-node` binary by running the following commands:

<pre><code>
cd $HOME <br/>
rm -rf celestia-node <br/>
git clone https://github.com/celestiaorg/celestia-node.git <br/>
cd celestia-node/ <br/>
git checkout tags/{arabicaVersions['node-latest-tag']} <br/>
make build <br/>
make go-install <br/>
make cel-key <br/>
</code></pre>

Verify that the binary is working and check the version with the `celestia
version` command:

<pre><code>
$ celestia version <br/>
Semantic version: {arabicaVersions['node-latest-tag']} <br/>
Commit: {arabicaVersions['node-latest-sha']} <br/>
Build Date: Thu Dec 15 10:19:22 PM UTC 2022 <br/>
System version: arm64/darwin <br/>
Golang version: go{constants.golangNode} <br/>
</code></pre>

</TabItem>
<TabItem value="mac" label="Mac (Intel)">

Installing `celestia-node` for Arabica Devnet means installing a specific version
to be compatible with the network.

Install the `celestia-node` binary by running the following commands:

<pre><code>
cd $HOME <br/>
rm -rf celestia-node <br/>
git clone https://github.com/celestiaorg/celestia-node.git <br/>
cd celestia-node/ <br/>
git checkout tags/{arabicaVersions['node-latest-tag']} <br/>
make build <br/>
make go-install <br/>
make cel-key <br/>
</code></pre>

Verify that the binary is working and check the version with the `celestia
version` command:

<pre><code>
$ celestia version <br/>
Semantic version: {arabicaVersions['node-latest-tag']} <br/>
Commit: {arabicaVersions['node-latest-sha']} <br/>
Build Date: Thu Dec 15 10:19:22 PM UTC 2022 <br/>
System version: amd64/darwin <br/>
Golang version: go{constants.golangNode} <br/>
</code></pre>

</TabItem>
</Tabs>

</TabItem>
</Tabs>
````

## Ports

When interacting with a Celestia node,
you may need to open ports on your machine to allow
communication between nodes, such as bridge nodes. It is essential that
specific ports are accessible. Make sure that your firewall allows
connections to the correct ports.

If you run a node on a cloud server, make sure that the ports are open
on the server's firewall. If you run a node at home, make sure that your
router allows connections to the correct ports.

For example, validator ports 9090
and 26657 need to be accessible by the bridge, and port 2121 is
required for P2P connections for all node types.

The following ports are used by Celestia nodes:

| Port | Protocol | Address | Description | Enabled by default on node | Flag |
| ---- | -------- | ------- | ----------- | ----------------- | ---- |
| 2121 | TCP/UDP | localhost | P2P | true | N/A |
| 26658 | HTTP | localhost | RPC | true | `--rpc.port string` |
| 26659 | HTTP | localhost | REST Gateway | false | `--gateway.port string` |

## Upgrading your binary

To upgrade your binary, you can use the following commands:

1. [Install](#install-celestia-node) the latest version of
the `celestia-node` binary. The latest version
will overwrite your existing binary.

:::danger
If you run into
errors after upgrading the binary and trying to restart
your node, you will need to follow
steps 2-4.
These steps are only necessary if you are upgrading from a version of
`celestia-node` with breaking changes.

If your node starts successfully, you do not need to follow steps 2-4.

:::

2. Clear the data store. Pay attention to the node type you are updating:
    1. For **bridge and full nodes _only_**:
        - Remove the data store:
        ```bash
        rm -rf ~./<path-to-node-store>/data
        rm -rf ~./<path-to-node-store>/transients
        rm -rf ~./<path-to-node-store>/index
        rm -rf ~./<path-to-node-store>/blocks
        ```
    2. For **light nodes _only_**:
        - Remove the data store:
        ```bash
        rm -rf ~./<path-to-node-store>/data
        ```
3. Remove your `config.toml` (for all node types):

```bash
rm ~./<path-to-node-store>/config.toml
```

4. Initialize your node:
```bash
celestia <node-type> init --p2p.network <network> [...flags]
```

5. Start your node:
```bash
celestia <node-type> start --p2p.network <network> [...flags]
```

## Troubleshooting

### Network selection

Note: If you do not select a network, the default network will be 'Mocha'.

```sh
celestia <node-type> init --p2p.network <network> 
celestia <node-type> start --p2p.network <network> --core.ip <address> --gateway --gateway.addr <ip-address> --gateway.port <port>
```

:::tip
Please refer to the [ports](../../nodes/celestia-node/#ports) section for information on
which ports are required to be open on your machine.
:::

> NOTE: It is advised before switching networks to reinitialize
  your node via `init` command. This is due to an old config being present.
  Re-initialisation will reset the config.

### Resetting your config

#### All nodes

If you an encounter an error, it is likely that an old config file is present:

```sh
Error: nodebuilder/share: interval must be positive; nodebuilder/core: invalid IP addr given:

# or

Error: nodebuilder/share: interval must be positive
```

You can re-initialize your node's config with the following commands:

:::tip
Save your config so custom values are not lost.
:::

1. First, remove your config:

  ```sh
  rm ~./<path-to-node-store>/config.toml
  ```

2. Re-initialize the node:

  ```sh
  celestia <node-type> init --p2p.network <network>
  ```

:::tip
If you have saved any custom values, add them back to the config.
:::

3. Start the node: 

  ```sh
  celestia <node-type> start --p2p.network <network>
  ```

:::tip
Please refer to the [ports](../../nodes/celestia-node/#ports) section for information on
which ports are required to be open on your machine.
:::

### Clearing the data store

#### Bridge and full nodes

:::danger
Make sure not to remove anything except the
directories listed below.
:::

1. First, remove the data store:

  ```sh
  rm -rf ~./<path-to-node-store>/data
  rm -rf ~./<path-to-node-store>/transients
  rm -rf ~./<path-to-node-store>/index
  rm -rf ~./<path-to-node-store>/blocks
  ```

2. Re-initialize the node:

  ```sh
  celestia <node type> init --p2p.network <network>
  ```

3. Start the node: 

  ```sh
  celestia <node type> start --p2p.network <network>
  ```

:::tip
Please refer to the [ports](../../nodes/celestia-node/#ports) section for information on
which ports are required to be open on your machine.
:::

#### Light nodes

:::danger
Make sure not to remove anything except the
`<path-to-node-store>/data` directory.
:::

1. First, remove the data store:

  ```sh
  rm -rf ~./<path-to-node-store>/data
  ```

2. Re-initialize the node:

  ```sh
  celestia light init --p2p.network <network>
  ```

3. Start the node: 

  ```sh
  celestia light start --p2p.network <network>
  ```

:::tip
Please refer to the [ports](../../nodes/celestia-node/#ports) section for information on
which ports are required to be open on your machine.
:::

##### Example for Blockspace Race

Here's an example for clearing the data store
on Blockspace Race with a light node:

:::danger
Make sure not to remove anything except the
`<path-to-node-store>/data` directory.
:::

```sh
rm -rf ~./celestia-light-blockspacerace-0/data
celestia light init --p2p.network blockspacerace
```

Your output will look similar to below:

```sh
2022-11-01T22:23:19.581+0100	INFO	node	nodebuilder/init.go:20	Initializing Light Node Store over '/Users/joshstein/.celestia-light-blockspacerace-0'
2022-11-01T22:23:19.582+0100	INFO	node	nodebuilder/init.go:51	Saving config	{"path": "/Users/joshstein/.celestia-light-blockspacerace-0/config.toml"}
2022-11-01T22:23:19.582+0100	INFO	node	nodebuilder/init.go:52	Node Store initialized
```

Then start your node:

```sh
celestia light start --p2p.network blockspacerace --core.ip <address> --gateway --gateway.addr <ip-address> --gateway.port <port>
```

:::tip
Please refer to the [ports](../../nodes/celestia-node/#ports) section for information on
which ports are required to be open on your machine.
:::